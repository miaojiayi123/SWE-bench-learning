# SWE-agent：基于语言模型（LM）和代理-计算机接口（ACI）的代理

基于论文总结，参考 [SWE-agent 文档](https://swe-agent.com)。

---

## ACI：代理-计算机接口（Agent-Computer Interface）

### ACI 特点
1. 在语言模型（LM）代理和计算机之间的抽象层。
2. 类似于集成开发环境（IDE），专为 LM 优化，提供接口以推动软件工程自动化。
3. 包括代码搜索、文件查看器和文件编辑器。
4. LM 无法直接操作基于 GUI 的应用程序，因缺乏视觉理解能力。ACI 帮助 LM 代理理解应用程序在先前更改后的状态、管理历史记录，并提供高效可靠的动作。

### ACI 设计原则
1. **动作应简单易懂**：减少复杂性，便于 LM 使用。
2. **动作应紧凑高效**：整合操作，单步完成关键任务。
3. **环境反馈应信息丰富但简洁**：如编辑文件时更新修订内容，帮助代理决策。
4. **护栏减轻错误传播并加速恢复**：在 LM 编辑应用前检查代码，防止错误。

---

## SWE-agent 如何为 LM 提供 ACI：技术组件

### 搜索与导航
#### 利用问题描述信号快速定位问题
1. 特殊命令：`find_file`、`search_file`、`search_dir`。
2. 鼓励高效搜索，限制最多返回 50 条结果。

| 类别       | 命令                            | 文档描述                                                                 |
|------------|---------------------------------|-------------------------------------------------------------------------|
| **搜索**   | `search_file <search_term> [<file>]` | 在指定文件中搜索词。若未提供文件，则在当前打开文件中搜索。             |
|            | `search_dir <search_term> [<dir>]`   | 在指定目录的所有文件中搜索词。若未提供目录，则在当前目录搜索。         |
|            | `find_file <file_name> [<dir>]`      | 在指定目录中查找给定文件名的所有文件。若未提供目录，则在当前目录搜索。 |

### 文件查看器（File Viewer）
1. 调用 `open` 命令使用交互式文件查看器，传入相关文件路径。
2. 使用 `scroll_down` 和 `scroll_up` 移动窗口，`goto` 跳转到特定行。

| 类别       | 命令                            | 文档描述                                                                 |
|------------|---------------------------------|-------------------------------------------------------------------------|
| **文件查看器** | `open <path> [<line_number>]` | 打开指定路径的文件。若提供行号，窗口将移动到包含该行。                   |
|            | `goto <line_number>`           | 将窗口移动到显示指定行号。                                               |
|            | `scroll_down`                  | 将窗口向上移动 100 行。                                                  |
|            | `scroll_up`                    | 将窗口向下移动 100 行。                                                  |

### 文件编辑器（File Editor）
#### `edit` 命令解决 Shell-only 编辑的复杂性，提升 LM 效率
1. `edit` 命令与文件查看器协作，允许代理替换打开文件中特定行范围。
2. 集成 linter（护栏），检查语法错误。
3. 丢弃无效编辑，提供反馈。

| 类别       | 命令                                      | 文档描述                                                                 |
|------------|-------------------------------------------|-------------------------------------------------------------------------|
| **文件编辑** | `edit <n>:<m> <replacement_text> end_of_edit` | 将打开文件中第 n 至 m 行（含）替换为给定文本。Python 文件编辑后检查语法错误，若有则不执行。 |
|            | `create <filename>`                      | 创建并打开指定名称的新文件。                                             |

### 上下文管理
- 提供 ACI 命令的正确使用示范，确保代理理解操作。

---

## 结果分析

- **人类用户界面并不总是适合作为代理-计算机接口**：Shell-only 复杂且无反馈。
- **紧凑高效的文件编辑对性能至关重要**：`edit` 单步多行提升效率。
- **护栏改善错误恢复**：拦截语法错误，减少级联失败。

### 代理行为分析
1. **起步**: 复现（`create`）或定位（`find_file` / `search_dir`）。
2. **循环**: “编辑（`edit`）后执行（`python`）”。

---
